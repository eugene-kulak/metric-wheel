env:
  global:
    - REPO_DIR="metric"
    - PACKAGE_DIR="metric/python"
    - BUILD_COMMIT=HEAD
    - PLAT=x86_64
    - BUILD_DEPENDS="auditwheel==3.1.0"
    - TEST_DEPENDS="pytest"
    - UNICODE_WIDTH=32
    - PYPI_SERVER="https://test.pypi.org/legacy/"
    - secure: NEV44aOtX0I8MWS/8UC+Gwq//gE9DVmjFL5Kp5wM3Md5/dF7Of2KmAsuzRuSTj7E/HHJXT3htTy9mu/xQuA4gNCLuNWPl0Vt5dVe4qtNLnlB4fWeMv5J7IyOo1uHfiwgdQR8KAPIfQL2YCqrBKpkE+7TdDXAOHxIGDzoynwtsFJeJ4XSSSftWOZV9GFLQ8TNSNYVIGSdzMM89LLcbMchiXitD+EzAEOKGCMwx0PqN/OUruFPm1JsFEIav94ySYimkif9TkkwC33YcW+51LPKI6wc17wNQbtMvjs0shGkoOoIy2Us31VMYtWltdqr5eBrkebX8GrYSHLvWa9pQHTKpfs7YYrz0HYNmasggkrWBlfcxQYAZGQUikWlEdJBC8FN1GfAMyVQCSq69dVxxMxAS8c8ZNs2B/EheKprbDPwg1tgTVEmgqAC8PpDgHtojpX2iYJKEBVMynsuqUd8tGlG2/n41CQgz5J6INVRHkVueJPUNa8hcBAhpW1u8eWx1pmU0ul/urYWPLBVyUY19BFwxZw8MIuZgocF3mQOWBsMyqJ54XZbzc+EAtbgnAx0/CFvSqYylluVwlJc2NAYVgCcArX32zgj1kzmg/o4/n+Pcgmc3jx7+8OR+YzY3OQuli7WxFsrvvGyeDCEgD8/XAYGx0IypUNrhshYADJHEIFeFmY=
    - MB_PYTHON_VERSION=3.7
language: generic
python: 3.7
dist: xenial
services: docker

jobs:
  include:
  # Linux builds
    - os: linux
      env:
        - MB_PYTHON_VERSION=3.6
#    - os: linux
#      env:
#        - MB_PYTHON_VERSION=3.7
#    - os: linux
#      env:
#        - MB_PYTHON_VERSION=3.8
#   OSX builds
#    - os: osx
#      env:
#        - MB_PYTHON_VERSION=3.6
#        - VENV=venv
#    - os: osx
#      env:
#        - MB_PYTHON_VERSION=3.7
#        - VENV=venv
#    - os: osx
#      env:
#        - MB_PYTHON_VERSION=3.8
#        - VENV=venv
  # Default OSX (xcode image) is 10.13 (xcode 9.4.1) as of 2020-03-24
  # See: https://docs.travis-ci.com/user/reference/osx/
    - os: osx
      env:
        - MB_PYTHON_VERSION=3.7
        - MB_PYTHON_OSX_VER=10.9
#    - os: osx
#      osx_image: xcode10
#      env:
#        - MB_PYTHON_VERSION=3.6
#    - os: osx
#      osx_image: xcode10
#      env:
#        - MB_PYTHON_VERSION=3.7
#    - os: osx
#      osx_image: xcode10
#      env:
#        - MB_PYTHON_VERSION=3.8
#    - os: osx
#      osx_image: xcode11.3
#      env:
#        - MB_PYTHON_VERSION=3.6
#    - os: osx
#      osx_image: xcode11.3
#      env:
#        - MB_PYTHON_VERSION=3.7
#    - os: osx
#      osx_image: xcode11.3
#      env:
#        - MB_PYTHON_VERSION=3.8
#    - os: windows
#      env:
#        - MB_PYTHON_VERSION=3.8

before_install:
  - source multibuild/common_utils.sh
  - source multibuild/travis_steps.sh
  - before_install
install:
  - clean_code $REPO_DIR $BUILD_COMMIT
  - build_wheel $PACKAGE_DIR $PLAT
#script:
#  - install_run $PLAT
after_success:
  - source publish.sh
  - upload_to_pypi $PYPI_SERVER
